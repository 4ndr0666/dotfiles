# Mpv.conf
# Author: 4ndr0666
# ================================ // MPV.CONF //

# Video/GPU________________________
vaapi-device=/dev/dri/renderD128
vo=gpu-next
gpu-api-set=opengl
hwdec=auto-copy
#auto-copy-safe
hwdec-codecs=-cuda,auto
opengl-early-flush=yes
x11-bypass-compositor=yes
correct-pts=no
vd-lavc-dr=yes
hr-seek=absolute
hr-seek-framedrop=no
framedrop=no
deinterlace=no
#display-fps-override=60
#wayland-internal-vsync=no

# Playlists/Playback__________________
loop-file=inf
speed=0.50
play-direction=+
stop-playback-on-init-failure=yes
no-resume-playback
save-position-on-quit
autocreate-playlist=filter
directory-filter-types=.mp4,.mkv,.gif,.m4v,.wmv,.mpg,.avi,.webm,.mov,.3gp,.mpeg,.ts
reset-on-next-file=audio-delay,mute,pause,speed,sub-delay,video-aspect-override,video-pan-x,video-pan-y,video-rotate,video-zoom,volume

# Audio________
volume-max=250
audio-pitch-correction=yes
af=acompressor=ratio=4,loudnorm
audio-fallback-to-null=yes
# alsa/sysdefault:CARD=PCH
#video-sync=display-resample-desync
video-sync=desync
#video-sync=display-resample
#no-audio

# Window________
border=no
msg-color=yes
cursor-autohide=1000
force-window=immediate
force-render
stop-screensaver=always
osd-font=fluent-system-icons
osd-bar-align-y=-1
osd-level=1
keep-open=always
keep-open-pause=yes
osc=no
window-scale=0.6
geometry=3840x2160
no-hidpi-window-scale
# osd-font-size=24
# script-opts=osc-layout=bottombar
# osd-border-size=1
# osd-duration=2000
# sub-visibility=yes
# autofit-larger=90%x90%
# osd-outline-color="#15FFFF"
# geometry=640x360+0-0
# keepaspect=no
# autofit-larger=88%x88%
# autofit-larger=30%x30%
# display-tags=Title, Channel_URL, service_name
# osd-playing-msg=File: ${filename}
# script-opts=osc-layout=bottombar,osc-seekbarstyle=bar
# osd-bar=no

# Terminal________
term-osd-bar=yes
#term-status-msg="Time: ${time-pos}"
# term-title=yes
#term-staus-msg=V: (playback-time)/(duration) - (percent-pos)
term-osd-bar-chars="──╼ ·"

# YTDL___________________
ytdl=yes
#try_ytdl_first=yes
ytdl-format=best
#ytdl_path=/usr/bin/yt-dlp

# Special Opts__________________
index=recreate

# Images___________________
vo-image-format=webp
vo-image-webp-lossless=yes
vo-image-webp-quality=90
vo-image-outdir=/home/andro/Pictures/caps
image-display-duration=8

# Screenshots__________________
#screenshot-format=png
screenshot-webp-lossless=yes
screenshot-webp-quality=100
screenshot-dir=/home/andro/Pictures/screenshots
screenshot-template="%F - [%P]v%#01n"

# Profiles________________________
[playdir]
profile-desc=Playdir
loop-playlist=force
loop-file=no
speed=0.5
shuffle=yes
keep-open-pause=yes
input-ipc-server=/tmp/mpvsocket
no-framedrop
no-resume-playback
ignore-path-in-watch-later-config=yes

[enhance]
profile-desc=Enhanced
scale=ewa_lanczossharp
cscale=spline36
dscale=mitchell
linear-upscaling=yes
sigmoid-upscaling=yes
sharpen=1
scale-antiring=0.6
dither-depth=auto
temporal-dither=yes
dither=fruit
deband=yes # enabled by default
deband-iterations=4 # deband steps
deband-threshold=30 # deband strength
deband-range=16 # deband range
deband-grain=5 # dynamic grain: set to "0" if using the static grain shader

[slomo]
profile-desc=Slowmo
display-fps-override=60
tscale=oversample
zimg-dither=error-diffusion
video-sync=display-resample
deinterlace=yes
interpolation=yes
interpolation-preserve=yes

[svp]
profile-desc=SVP
input-ipc-server=/tmp/mpvsocket
hwdec=auto-copy
hr-seek=always
hr-seek-framedrop=no
no-resume-playback
ignore-path-in-watch-later-config=yes

[network]
profile-desc=Network
user-agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:121.0) Gecko/20100101 Firefox/121.0"
cache=yes
cache-on-disk=yes
cache-pause=yes
cache-pause-wait=10
cache-secs=10
cache-pause-initial=yes
demuxer-max-back-bytes=512MiB
demuxer-readahead-secs=10
profile=fast
hls-bitrate=max # use max quality for HLS streams

[play_with_mpv]
profile-desc=Play_with_mpv
ontop=yes
border=no
window-scale=0.4
geometry=100%:100%

[4k60] # 2160p @ 60fps (3840x2160 UHDTV)
profile-desc=4k60
profile-cond=((width ==3840 and height ==2160) and p["estimated-vf-fps"]>=31)
interpolation=no # no motion interpolation is required
deband=no # turn off debanding because presume wide color gamut
interpolation=no # turn off interpolation because presume 60fps
glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl" # UHD videos are YUV420 so chroma upscaling is needed
# glsl-shader="~/.config/mpv/shaders/CfL_Prediction_Lite.glsl" # less resource-intensive chroma upscaling

[4k30] # 2160p @ 24-30fps (3840x2160 UHDTV)
profile-cond=((width ==3840 and height ==2160) and p["estimated-vf-fps"]<31)
deband=no # turn off debanding because presume wide color gamut
glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"  # UHD videos are YUV420 so chroma upscaling is needed
# glsl-shader="~/.config/mpv/shaders/CfL_Prediction_Lite.glsl" # less resource-intensive chroma upscaling

[full-hd60] # 1080p @ 60fps (progressive ATSC)
profile-desc=full-hd60
profile-cond=((width ==1920 and height ==1080) and not p["video-frame-info/interlaced"] and p["estimated-vf-fps"]>=31)
interpolation=no # no motion interpolation is required
glsl-shader="~/.config/mpv/shaders/ArtCNN_C4F16.glsl" # luma upscaling (doubler)
# glsl-shader="~/.config/mpv/shaders/ravu-lite-ar-r4.hook"  # less resource-intensive luma upscaling (doubler)
glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"  # HD videos are YUV420 so chroma upscaling is needed
# glsl-shader="~/.config/mpv/shaders/CfL_Prediction_Lite.glsl" # less resource-intensive chroma upscaling

[full-hd30] # 1080p @ 24-30fps (NextGen TV/ATSC 3.0, progressive Blu-ray)
profile-desc=full-hd30
profile-cond=((width ==1920 and height ==1080) and not p["video-frame-info/interlaced"] and p["estimated-vf-fps"]<31)
glsl-shader="~/.config/mpv/shaders/ArtCNN_C4F16.glsl" # luma upscaling (doubler)
# glsl-shader="~/.config/mpv/shaders/ravu-lite-ar-r4.hook" # less resource-intensive luma upscaling (doubler)
glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"  # HD videos are YUV420 so chroma upscaling is needed
# glsl-shader="~/.config/mpv/shaders/CfL_Prediction_Lite.glsl" # less resource-intensive chroma upscaling

[full-hd-interlaced] # 1080i @ 24-30fps (HDTV, interlaced Blu-rays)
profile-desc=full-hd-interlaced
profile-cond=((width ==1920 and height ==1080) and p["video-frame-info/interlaced"] and p["estimated-vf-fps"]<31)
deinterlace=yes # MPV now uses BWDIF by default
glsl-shader="~/.config/mpv/shaders/ArtCNN_C4F16.glsl" # luma upscaling (doubler)
# glsl-shader="~/.config/mpv/shaders/ravu-lite-ar-r4.hook" # less resource-intensive luma upscaling (doubler)
glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"  # HD videos are YUV420 so chroma upscaling is needed
# glsl-shader="~/.config/mpv/shaders/CfL_Prediction_Lite.glsl" # less resource-intensive chroma upscaling

[hd] # 720p @ 60 fps (HDTV, Blu-ray - progressive)
profile-desc=hd
profile-cond=(width ==1280 and height ==720)
interpolation=no # no motion interpolation is required
glsl-shader="~/.config/mpv/shaders/ravu-zoom-ar-r3.hook" # luma upscaling (fractional)
glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"  # HD videos are YUV420 so chroma upscaling is needed
# glsl-shader="~/.config/mpv/shaders/CfL_Prediction_Lite.glsl" # less resource-intensive chroma upscaling

[sdtv-ntsc] # 640x480, 704x480, 720x480 @ 30fps (NTSC DVD - interlaced)
profile-desc=sdtv-ntsc
profile-cond=((width ==640 and height ==480) or (width ==704 and height ==480) or (width ==720 and height ==480))
deinterlace=yes # MPV now uses BWDIF by default
glsl-shader="~/.config/mpv/shaders/ravu-zoom-ar-r3.hook" # luma upscaling (fractional)
glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"  # SD videos are YUV420 so chroma upscaling is needed
# glsl-shader="~/.config/mpv/shaders/CfL_Prediction_Lite.glsl" # less resource-intensive chroma upscaling

[sdtv-pal] # 352x576, 480x576, 544x576, 720x576 @ 30fps (PAL broadcast or DVD - interlaced)
profile-desc=sdtv-pal
profile-cond=((width ==352 and height ==576) or (width ==480 and height ==576) or (width ==544 and height ==576) or (width ==720 and height ==576))
deinterlace=yes # MPV now uses BWDIF by default
glsl-shader="~/.config/mpv/shaders/ravu-zoom-ar-r3.hook" # luma upscaling (fractional)
glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"  # SD videos are YUV420 so chroma upscaling is needed
# glsl-shader="~/.config/mpv/shaders/CfL_Prediction_Lite.glsl" # less resource-intensive chroma upscaling

# Extensions_______________________
[extension.gif]
loop-file=inf

[extension.webm]
loop-file=inf
